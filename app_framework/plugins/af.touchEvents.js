//Touch events are from zepto/touch.js
!function($){function parentIfText(node){return"tagName"in node?node:node.parentNode}function swipeDirection(x1,x2,y1,y2){var xDelta=Math.abs(x1-x2),yDelta=Math.abs(y1-y2);return xDelta>=yDelta?x1-x2>0?"Left":"Right":y1-y2>0?"Up":"Down"}function longTap(){touch.last&&Date.now()-touch.last>=longTapDelay&&(touch.el.trigger("longTap"),touch={})}var touchTimeout,longTapTimer,touch={},longTapDelay=750;$(document).ready(function(){var prevEl;$(document.body).bind("touchstart",function(e){if(e.originalEvent&&(e=e.originalEvent),e.touches&&0!==e.touches.length){var now=Date.now(),delta=now-(touch.last||now);e.touches&&0!==e.touches.length&&(touch.el=$(parentIfText(e.touches[0].target)),touchTimeout&&clearTimeout(touchTimeout),touch.x1=e.touches[0].pageX,touch.y1=e.touches[0].pageY,touch.x2=touch.y2=0,delta>0&&250>=delta&&(touch.isDoubleTap=!0),touch.last=now,longTapTimer=setTimeout(longTap,longTapDelay),$.ui.useAutoPressed&&!touch.el.data("ignore-pressed")&&touch.el.addClass("pressed"),prevEl&&$.ui.useAutoPressed&&!prevEl.data("ignore-pressed")&&prevEl.removeClass("pressed"),prevEl=touch.el)}}).bind("touchmove",function(e){e.originalEvent&&(e=e.originalEvent),touch.x2=e.touches[0].pageX,touch.y2=e.touches[0].pageY,clearTimeout(longTapTimer)}).bind("touchend",function(e){e.originalEvent&&(e=e.originalEvent),touch.el&&($.ui.useAutoPressed&&!touch.el.data("ignore-pressed")&&touch.el.removeClass("pressed"),touch.isDoubleTap?(touch.el.trigger("doubleTap"),touch={}):touch.x2>0||touch.y2>0?((Math.abs(touch.x1-touch.x2)>30||Math.abs(touch.y1-touch.y2)>30)&&touch.el.trigger("swipe")&&touch.el.trigger("swipe"+swipeDirection(touch.x1,touch.x2,touch.y1,touch.y2)),touch.x1=touch.x2=touch.y1=touch.y2=touch.last=0):"last"in touch&&(touch.el.trigger("tap"),touchTimeout=setTimeout(function(){touchTimeout=null,touch.el&&touch.el.trigger("singleTap"),touch={}},250)))}).bind("touchcancel",function(){touch.el&&$.ui.useAutoPressed&&!touch.el.data("ignore-pressed")&&touch.el.removeClass("pressed"),touch={},clearTimeout(longTapTimer)})}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(m){$.fn[m]=function(callback){return this.bind(m,callback)}})}(jq);